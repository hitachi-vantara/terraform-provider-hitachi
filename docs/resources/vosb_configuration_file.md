---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "hitachi_vosb_configuration_file Resource - terraform-provider-hitachi"
subcategory: ""
description: |-
  VOS Block: Create and/or download configuration definition file of the storage system.
---

# hitachi_vosb_configuration_file (Resource)

VOS Block: Create and/or download configuration definition file of the storage system.

## Example Usage

```terraform
# Hitachi VOS Block: Generate and Download Configuration File
#
# This resource allows you to create or retrieve configuration files for a Hitachi VSP One SDS Block (VOSB) system
# in cloud or bare-metal environments. It supports different cloud providers and maintenance operations such as
# adding or replacing storage nodes and drives.
#
# The `hitachi_vosb_configuration_file` resource interfaces with the VOSB system’s REST API and can be used
# in HashiCorp Configuration Language (HCL) to automate generation and optional download of system configuration files.
#
# ## Usage Modes
# Choose one of the modes below to control how the file is generated or downloaded:
#
# - Set `download_existconfig_only = true` to **only download** the most recent existing configuration file.
# - Set `create_only = true` to **only create** a new configuration file without downloading.
# - By default, both `create_only` and `download_existconfig_only` are `false`, which means the file will be **created and downloaded**.
#
# ## Cloud Provider Behavior
# The `expected_cloud_provider` parameter is used only to validate input combinations based on the expected cloud environment.
# If there is a mismatch between the given 'expected_cloud_provider' and the VOSB environment, the request will still proceed.
# The VOSB system will apply its actual cloud provider behavior regardless of this value.
#
# - **google / azure**: Additional input parameters are required based on the selected maintenance operation (`export_file_type`).
# - **aws / baremetal**: All additional parameters are ignored — only basic creation/download will occur.
#
# ## Maintenance Operation Types (`export_file_type`)
# The type of maintenance operation determines what additional parameters are required:
#
# - `"Normal"` *(default)*: No additional parameters are needed.
# - `"AddStorageNodes"`: Requires `machine_image_id` and `address_setting`.
# - `"ReplaceStorageNode"`: Requires `machine_image_id` and `node_id`.
# - `"AddDrives"`: Requires `number_of_drives` (between 6 and 24).
# - `"ReplaceDrive"`: Requires either `drive_id` (UUID) or `recover_single_drive = true`.
#
# ## Parameters
# - `vosb_address`: **(Required)** IP or hostname of the VOSB system's REST API.
# - `download_existconfig_only`: **(Optional)** If `true`, skips creation and only downloads the latest file.
# - `create_only`: **(Optional)** If `true`, creates the file but skips downloading it.
# - `download_path`: **(Optional)** Path to save the downloaded file. Ignored if no download occurs.
#      Can be either:
#      - A directory: File is saved there with a default name (e.g. ConfigurationFiles_20250625_171510.tar.gz)
#      - A full file path: File is saved using the given name; `.tar.gz` is added if no extension is given.
#        Despite the name, this can be a directory or full file path.
#
# - `create_configuration_file_param`: **(Optional)** A block of parameters used only for Google Cloud and Azure to generate the configuration file:
#
#   - `expected_cloud_provider`: **(Required)** One of `"google"`, `"azure"`, `"aws"`, or `"baremetal"`. Controls behavior of other fields.
#   - `export_file_type`: **(Optional)** One of `"Normal"`, `"AddStorageNodes"`, `"ReplaceStorageNode"`, `"AddDrives"`, `"ReplaceDrive"`. Defaults to `"Normal"`.
#   - `machine_image_id`: **(Optional)** Required for node operations.
#   - `number_of_drives`: **(Optional)** Must be between 6 and 24 for `AddDrives`.
#   - `recover_single_drive`: **(Optional)** If `true`, replaces a single removed drive.
#   - `drive_id`: **(Optional)** UUID of drive to replace. Not allowed if `recover_single_drive = true`.
#   - `recover_single_node`: **(Optional)** If `true`, recovers a node during replacement.
#   - `node_id`: **(Optional)** UUID of the node to replace. Required for `ReplaceStorageNode`.
#   - `address_setting`: **(Optional)** A list (1–6 items) of storage node IP settings for `AddStorageNodes`.
#
# ## Outputs
# - `status`: Operation status returned from the VOSB system.
# - `output_file_path`: The full local path to the resulting downloaded configuration file.
#
# ## Notes
# - Fields not applicable to the selected `expected_cloud_provider` or `export_file_type` are ignored.
# - Input combinations are validated at runtime.
#
# ## Examples

resource "hitachi_vosb_configuration_file" "download" {
  vosb_address              = var.vosb_address
  download_existconfig_only = true
  download_path             = "/tmp/myDownloadConfig"
  create_only               = false
}

output "download_output" {
  value = resource.hitachi_vosb_configuration_file.download
}

# resource "hitachi_vosb_configuration_file" "create_download" {
#   vosb_address              = var.vosb_address
#   download_existconfig_only = false
#   download_path             = "/tmp/myDownloadConfig.tar.gz"
#   create_only               = false
# }

# output "create_download_output" {
#   value = resource.hitachi_vosb_configuration_file.create_download
# }

# resource "hitachi_vosb_configuration_file" "create" {
#   vosb_address = var.vosb_address
#   # download_existconfig_only = false
#   # download_path             = "/tmp/myDownloadConfig"
#   create_only = true
# }

# output "create_output" {
#   value = resource.hitachi_vosb_configuration_file.create
# }

# resource "hitachi_vosb_configuration_file" "normal" {
#   vosb_address  = var.vosb_address
#   download_path = "/tmp/myDownloadConfig"
#   # create_only  = true
#   create_configuration_file_param {
#     expected_cloud_provider = "google"
#     export_file_type        = "Normal"
#     machine_image_id        = "ami-0123456789abcdef0"
#     address_setting {
#       index                       = 1
#       control_port_ipv4_address   = "192.168.0.1"
#       internode_port_ipv4_address = "192.168.0.2"
#       compute_port_ipv4_address   = "192.168.0.3"
#     }
#   }
# }

# output "normal_output" {
#   value = resource.hitachi_vosb_configuration_file.normal
# }

# resource "hitachi_vosb_configuration_file" "add_storage_node" {
#   vosb_address  = var.vosb_address
#   download_path = "/tmp/myDownloadConfig"
#   # create_only  = true
#   create_configuration_file_param {
#     expected_cloud_provider = "azure"
#     export_file_type        = "AddStorageNodes"
#     machine_image_id        = "ami-0123456789abcdef0"
#     address_setting {
#       index                       = 1
#       control_port_ipv4_address   = "192.168.0.1"
#       internode_port_ipv4_address = "192.168.0.2"
#       compute_port_ipv4_address   = "192.168.0.3"
#       compute_port_ipv6_address   = "2001:db8:85a3::8a2e:370:7334" // only for Azure
#     }
#   }
# }

# output "add_storage_node_output" {
#   value = resource.hitachi_vosb_configuration_file.add_storage_node
# }

# resource "hitachi_vosb_configuration_file" "replace_drive" {
#   vosb_address = var.vosb_address
#   create_only  = true
#   create_configuration_file_param {
#     expected_cloud_provider = "google"
#     export_file_type        = "ReplaceDrive"
#     machine_image_id        = "ami-0123456789abcdef0"
#     recover_single_drive    = false
#     drive_id                = "6f1f57a3-8b5a-4aef-9c8f-0a617e2a73d9"
#   }
# }

# output "replace_drive_output" {
#   value = resource.hitachi_vosb_configuration_file.replace_drive
# }

# resource "hitachi_vosb_configuration_file" "add_drives" {
#   vosb_address = var.vosb_address
#   create_only  = true
#   create_configuration_file_param {
#     expected_cloud_provider = "google"
#     export_file_type        = "AddDrives"
#     number_of_drives        = 6
#   }
# }

# output "add_drives_output" {
#   value = resource.hitachi_vosb_configuration_file.add_drives
# }

# resource "hitachi_vosb_configuration_file" "replace_storage_node" {
#   vosb_address = var.vosb_address
#   create_only  = true
#   create_configuration_file_param {
#     expected_cloud_provider = "google"
#     export_file_type        = "ReplaceStorageNode"
#     machine_image_id        = "ami-0123456789abcdef0"
#     node_id                 = "6f1f57a3-8b5a-4aef-9c8f-0a617e2a73d9"
#     recover_single_node     = false
#   }
# }

# output "replace_storage_node_output" {
#   value = resource.hitachi_vosb_configuration_file.replace_storage_node
# }
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `vosb_address` (String) The address (IP or hostname) of the VOSB system's REST API.

### Optional

- `create_configuration_file_param` (Block List, Max: 1) Parameters for creating a configuration file (relevant for Google Cloud and Azure only). Ignored for AWS and Bare Metal. (see [below for nested schema](#nestedblock--create_configuration_file_param))
- `create_only` (Boolean) If true, creates a new configuration file but does not download it. Ignored if `download_existconfig_only` is true.
- `download_existconfig_only` (Boolean) If true, skips creation and only downloads the latest existing configuration file. Requires `download_path`. All other parameters are ignored.
- `download_path` (String) Path to save the downloaded configuration file. Ignored if no download occurs. Can be a directory or a specific file path.

### Read-Only

- `id` (String) The ID of this resource.
- `output_file_path` (String) The full path where the downloaded file is saved. Appends .tar.gz if `download_path` is a filename without extension.
- `status` (String) The status of the configuration file operation.

<a id="nestedblock--create_configuration_file_param"></a>
### Nested Schema for `create_configuration_file_param`

Optional:

- `address_setting` (Block List, Max: 6) IP settings to be assigned to storage nodes being added. Mandatory if export_file_type is AddStorageNodes. (see [below for nested schema](#nestedblock--create_configuration_file_param--address_setting))
- `drive_id` (String) UUID of the drive to replace. Must not be set if `recover_single_drive` is true.
- `expected_cloud_provider` (String) Specifies the expected cloud provider type. Valid values: "google", "azure", "aws", "baremetal".

	- Used to validate combinations of inputs based on the deployment environment.
	- If set to "google" or "azure", specific parameters may be required for certain operations.
	- If set to "aws" or "baremetal" (default), other cloud-specific inputs are ignored. These behave identically.
	- Note: The actual cloud provider is determined by the VOSB system at the "vosb_address" endpoint.
	If there's a mismatch, the request still proceeds and behaves according to the actual environment.
- `export_file_type` (String) Specifies the type of configuration file to generate. Default: 'Normal'.
	Valid values: Normal, AddStorageNodes, ReplaceStorageNode, AddDrives, ReplaceDrive.

	Determines which additional parameters are needed:
	- Normal: All other parameters are ignored.
	- AddStorageNodes: Requires 'machine_image_id' and 'address_setting'.
	- ReplaceStorageNode:
		- Google Cloud: Requires 'machine_image_id' and 'node_id'. Optionally 'recover_single_node'.
		- Azure: Requires 'machine_image_id'.
	- AddDrives: Requires 'number_of_drives'.
	- ReplaceDrive (Google Cloud only): Requires 'drive_id' or 'recover_single_drive'.

	Note:
	- Ignored in AWS and Bare Metal environments.
	- Used only in Google Cloud or Azure to control behavior.
- `machine_image_id` (String) ID or URI of the VM image used in AddStorageNodes or ReplaceStorageNode operations.
- `node_id` (String) UUID of the storage node to replace. Required for ReplaceStorageNode.
- `number_of_drives` (Number) Number of drives to install per node in AddDrives. Must be between 6 and 24.
- `recover_single_drive` (Boolean) Whether to recover a removed drive during a ReplaceDrive operation.
- `recover_single_node` (Boolean) Whether to recover a storage node during a ReplaceStorageNode operation.

<a id="nestedblock--create_configuration_file_param--address_setting"></a>
### Nested Schema for `create_configuration_file_param.address_setting`

Required:

- `compute_port_ipv4_address` (String) IPv4 address of the compute port.
- `control_port_ipv4_address` (String) IPv4 address of the control port.
- `index` (Number) The ID of the node to be added. Must be 1 to 6.
- `internode_port_ipv4_address` (String) IPv4 address of the internode port.

Optional:

- `compute_port_ipv6_address` (String) IPv6 address of the compute port (Azure only).
